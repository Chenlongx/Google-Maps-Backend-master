<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>äº§å“æ¨å¹¿ä¸­å¿ƒ - ä»£ç†ç³»ç»Ÿ</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #27ae60;
            --primary-hover-color: #229954;
            --secondary-color: #3498db;
            --success-color: #27ae60;
            --warning-color: #f39c12;
            --danger-color: #e74c3c;
            --light-gray-color: #f8f9fa;
            --text-color: #343a40;
            --border-color: #e9ecef;
            --white-color: #ffffff;
            --shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            --border-radius: 8px;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Poppins', 'Arial', sans-serif;
            background-color: var(--light-gray-color);
            color: var(--text-color);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .header {
            text-align: center;
            margin-bottom: 40px;
        }

        .header h1 {
            font-size: 32px;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .header p {
            font-size: 16px;
            color: #666;
        }

        .products-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
            gap: 30px;
            margin-bottom: 40px;
        }

        .product-card {
            background: var(--white-color);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            overflow: hidden;
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.15);
        }

        .product-header {
            padding: 30px;
            text-align: center;
            background: linear-gradient(135deg, var(--primary-color), var(--primary-hover-color));
            color: var(--white-color);
        }

        .product-icon {
            font-size: 48px;
            margin-bottom: 15px;
        }

        .product-title {
            font-size: 24px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .product-subtitle {
            font-size: 14px;
            opacity: 0.9;
        }

        .product-content {
            padding: 30px;
        }

        .product-description {
            font-size: 14px;
            color: #666;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .features-list {
            list-style: none;
            margin-bottom: 25px;
        }

        .features-list li {
            padding: 8px 0;
            font-size: 14px;
            color: #555;
        }

        .features-list li:before {
            content: "âœ“";
            color: var(--success-color);
            font-weight: bold;
            margin-right: 10px;
        }

        .pricing-section {
            background: #f8f9fa;
            padding: 20px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
        }

        .pricing-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 15px;
            color: var(--text-color);
        }

        .pricing-options {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .pricing-option {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 10px;
            background: var(--white-color);
            border-radius: 4px;
            border: 1px solid var(--border-color);
        }

        .pricing-name {
            font-size: 14px;
            font-weight: 500;
        }

        .pricing-price {
            font-size: 14px;
            font-weight: 600;
            color: var(--primary-color);
        }

        .commission-info {
            background: #e8f5e8;
            padding: 15px;
            border-radius: var(--border-radius);
            margin-bottom: 20px;
        }

        .commission-title {
            font-size: 14px;
            font-weight: 600;
            color: var(--success-color);
            margin-bottom: 5px;
        }

        .commission-rate {
            font-size: 16px;
            font-weight: 700;
            color: var(--success-color);
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .btn {
            flex: 1;
            padding: 12px 20px;
            border: none;
            border-radius: var(--border-radius);
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            text-decoration: none;
            text-align: center;
            transition: all 0.3s;
        }

        .btn-primary {
            background-color: var(--primary-color);
            color: var(--white-color);
        }

        .btn-primary:hover {
            background-color: var(--primary-hover-color);
        }

        .btn-secondary {
            background-color: var(--secondary-color);
            color: var(--white-color);
        }

        .btn-secondary:hover {
            background-color: #2980b9;
        }

        .stats-section {
            background: var(--white-color);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 30px;
            margin-bottom: 30px;
        }

        .stats-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }

        .stat-item {
            text-align: center;
            padding: 20px;
            background: #f8f9fa;
            border-radius: var(--border-radius);
        }

        .stat-number {
            font-size: 24px;
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 5px;
        }

        .stat-label {
            font-size: 14px;
            color: #666;
        }

        .promotion-tools {
            background: var(--white-color);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 30px;
        }

        .tools-title {
            font-size: 20px;
            font-weight: 600;
            margin-bottom: 20px;
            text-align: center;
        }

        .tools-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
        }

        .tool-card {
            padding: 20px;
            background: #f8f9fa;
            border-radius: var(--border-radius);
            text-align: center;
        }

        .tool-icon {
            font-size: 32px;
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .tool-title {
            font-size: 16px;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .tool-description {
            font-size: 14px;
            color: #666;
            margin-bottom: 15px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .products-grid {
                grid-template-columns: 1fr;
            }
            
            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>äº§å“æ¨å¹¿ä¸­å¿ƒ</h1>
            <p>ä¸“ä¸šçš„æ•°æ®æ‹“å®¢å·¥å…·ï¼ŒåŠ©åŠ›æ‚¨çš„ä¸šåŠ¡å¢é•¿</p>
        </div>

        <!-- æ¨å¹¿ç»Ÿè®¡ -->
        <div class="stats-section">
            <h2 class="stats-title">æ¨å¹¿ç»Ÿè®¡</h2>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number" id="totalPromotions">0</div>
                    <div class="stat-label">æ€»æ¨å¹¿æ•°</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="totalCommissions">Â¥0</div>
                    <div class="stat-label">ç´¯è®¡ä½£é‡‘</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="activeUsers">0</div>
                    <div class="stat-label">æ´»è·ƒç”¨æˆ·</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="conversionRate">0%</div>
                    <div class="stat-label">è½¬åŒ–ç‡</div>
                </div>
            </div>
        </div>

        <!-- äº§å“å±•ç¤º -->
        <div class="products-grid">
            <!-- è°·æ­Œåœ°å›¾æ‹“å®¢ç¨‹åº -->
            <div class="product-card">
                <div class="product-header">
                    <div class="product-icon">ğŸ—ºï¸</div>
                    <h3 class="product-title">è°·æ­Œåœ°å›¾æ‹“å®¢ç¨‹åº</h3>
                    <p class="product-subtitle">æ™ºèƒ½æ•°æ®æŠ“å–ï¼Œç²¾å‡†å®¢æˆ·è·å–</p>
                </div>
                <div class="product-content">
                    <p class="product-description">
                        åŸºäºPlaywrightè‡ªåŠ¨åŒ–æŠ€æœ¯ï¼Œæ™ºèƒ½æŠ“å–è°·æ­Œåœ°å›¾å•†å®¶ä¿¡æ¯ï¼ŒåŒ…æ‹¬è”ç³»æ–¹å¼ã€åœ°å€ã€è¥ä¸šæ—¶é—´ç­‰å…³é”®æ•°æ®ï¼ŒåŠ©åŠ›ä¼ä¸šç²¾å‡†æ‹“å®¢ã€‚
                    </p>
                    <ul class="features-list">
                        <li>è‡ªåŠ¨åŒ–æ•°æ®æŠ“å–</li>
                        <li>æ™ºèƒ½å»é‡å¤„ç†</li>
                        <li>å¤šæ ¼å¼æ•°æ®å¯¼å‡º</li>
                        <li>å®šæ—¶ä»»åŠ¡æ‰§è¡Œ</li>
                        <li>æ•°æ®è´¨é‡éªŒè¯</li>
                    </ul>
                    <div class="pricing-section">
                        <h4 class="pricing-title">ä»·æ ¼æ–¹æ¡ˆ</h4>
                        <div class="pricing-options">
                            <div class="pricing-option">
                                <span class="pricing-name">åŸºç¡€ç‰ˆ</span>
                                <span class="pricing-price">Â¥299/æœˆ</span>
                            </div>
                            <div class="pricing-option">
                                <span class="pricing-name">ä¸“ä¸šç‰ˆ</span>
                                <span class="pricing-price">Â¥2,999/å¹´</span>
                            </div>
                            <div class="pricing-option">
                                <span class="pricing-name">ä¼ä¸šç‰ˆ</span>
                                <span class="pricing-price">å®šåˆ¶æŠ¥ä»·</span>
                            </div>
                        </div>
                    </div>
                    <div class="commission-info">
                        <div class="commission-title">ä»£ç†ä½£é‡‘</div>
                        <div class="commission-rate">20% æŒç»­åˆ†ä½£</div>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="generateProductLink('google-maps')">ç”Ÿæˆæ¨å¹¿é“¾æ¥</button>
                        <button class="btn btn-secondary" onclick="viewProductDemo('google-maps')">æŸ¥çœ‹æ¼”ç¤º</button>
                    </div>
                </div>
            </div>

            <!-- é‚®ä»¶è¿‡æ»¤ç¨‹åº -->
            <div class="product-card">
                <div class="product-header">
                    <div class="product-icon">ğŸ“§</div>
                    <h3 class="product-title">é‚®ä»¶è¿‡æ»¤ç¨‹åº</h3>
                    <p class="product-subtitle">é«˜æ•ˆé‚®ä»¶éªŒè¯ï¼Œæå‡è¥é”€æ•ˆæœ</p>
                </div>
                <div class="product-content">
                    <p class="product-description">
                        ä¸“ä¸šçš„é‚®ä»¶åœ°å€éªŒè¯æœåŠ¡ï¼Œå®æ—¶æ£€æµ‹é‚®ä»¶æœ‰æ•ˆæ€§ï¼Œè¿‡æ»¤æ— æ•ˆåœ°å€ï¼Œæå‡é‚®ä»¶è¥é”€çš„é€è¾¾ç‡å’Œè½¬åŒ–ç‡ã€‚
                    </p>
                    <ul class="features-list">
                        <li>å®æ—¶é‚®ä»¶éªŒè¯</li>
                        <li>æ‰¹é‡å¤„ç†æ”¯æŒ</li>
                        <li>å¤šç§éªŒè¯è§„åˆ™</li>
                        <li>è¯¦ç»†éªŒè¯æŠ¥å‘Š</li>
                        <li>APIæ¥å£æ”¯æŒ</li>
                    </ul>
                    <div class="pricing-section">
                        <h4 class="pricing-title">ä»·æ ¼æ–¹æ¡ˆ</h4>
                        <div class="pricing-options">
                            <div class="pricing-option">
                                <span class="pricing-name">æ ‡å‡†ç‰ˆ</span>
                                <span class="pricing-price">Â¥0.01/æ¡</span>
                            </div>
                            <div class="pricing-option">
                                <span class="pricing-name">é«˜çº§ç‰ˆ</span>
                                <span class="pricing-price">Â¥199/æœˆ</span>
                            </div>
                            <div class="pricing-option">
                                <span class="pricing-name">æ‰¹é‡ç‰ˆ</span>
                                <span class="pricing-price">Â¥0.005/æ¡</span>
                            </div>
                        </div>
                    </div>
                    <div class="commission-info">
                        <div class="commission-title">ä»£ç†ä½£é‡‘</div>
                        <div class="commission-rate">15% æŒç»­åˆ†ä½£</div>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="generateProductLink('email-filter')">ç”Ÿæˆæ¨å¹¿é“¾æ¥</button>
                        <button class="btn btn-secondary" onclick="viewProductDemo('email-filter')">æŸ¥çœ‹æ¼”ç¤º</button>
                    </div>
                </div>
            </div>

            <!-- WhatsAppè¿‡æ»¤ç¨‹åº -->
            <div class="product-card">
                <div class="product-header">
                    <div class="product-icon">ğŸ“±</div>
                    <h3 class="product-title">WhatsAppè¿‡æ»¤ç¨‹åº</h3>
                    <p class="product-subtitle">WhatsAppå·ç éªŒè¯ï¼Œç²¾å‡†è¥é”€</p>
                </div>
                <div class="product-content">
                    <p class="product-description">
                        ä¸“ä¸šçš„WhatsAppå·ç éªŒè¯æœåŠ¡ï¼Œæ£€æµ‹å·ç æ˜¯å¦æ³¨å†ŒWhatsAppï¼Œæä¾›è¯¦ç»†çš„éªŒè¯ç»“æœï¼Œä¼˜åŒ–è¥é”€ç­–ç•¥ã€‚
                    </p>
                    <ul class="features-list">
                        <li>WhatsAppå·ç æ£€æµ‹</li>
                        <li>æ‰¹é‡éªŒè¯å¤„ç†</li>
                        <li>å®æ—¶éªŒè¯ç»“æœ</li>
                        <li>è¯¦ç»†çŠ¶æ€æŠ¥å‘Š</li>
                        <li>APIæ¥å£é›†æˆ</li>
                    </ul>
                    <div class="pricing-section">
                        <h4 class="pricing-title">ä»·æ ¼æ–¹æ¡ˆ</h4>
                        <div class="pricing-options">
                            <div class="pricing-option">
                                <span class="pricing-name">åŸºç¡€ç‰ˆ</span>
                                <span class="pricing-price">Â¥0.02/æ¬¡</span>
                            </div>
                            <div class="pricing-option">
                                <span class="pricing-name">ä¸“ä¸šç‰ˆ</span>
                                <span class="pricing-price">Â¥299/æœˆ</span>
                            </div>
                            <div class="pricing-option">
                                <span class="pricing-name">ä¼ä¸šç‰ˆ</span>
                                <span class="pricing-price">Â¥0.01/æ¬¡</span>
                            </div>
                        </div>
                    </div>
                    <div class="commission-info">
                        <div class="commission-title">ä»£ç†ä½£é‡‘</div>
                        <div class="commission-rate">18% æŒç»­åˆ†ä½£</div>
                    </div>
                    <div class="action-buttons">
                        <button class="btn btn-primary" onclick="generateProductLink('whatsapp-filter')">ç”Ÿæˆæ¨å¹¿é“¾æ¥</button>
                        <button class="btn btn-secondary" onclick="viewProductDemo('whatsapp-filter')">æŸ¥çœ‹æ¼”ç¤º</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- æ¨å¹¿å·¥å…· -->
        <div class="promotion-tools">
            <h2 class="tools-title">æ¨å¹¿å·¥å…·</h2>
            <div class="tools-grid">
                <div class="tool-card">
                    <div class="tool-icon">ğŸ”—</div>
                    <h3 class="tool-title">æ¨å¹¿é“¾æ¥ç”Ÿæˆå™¨</h3>
                    <p class="tool-description">ä¸ºæ¯ä¸ªäº§å“ç”Ÿæˆä¸“å±æ¨å¹¿é“¾æ¥ï¼Œè‡ªåŠ¨è¿½è¸ªæ¨å¹¿æ•ˆæœ</p>
                    <button class="btn btn-primary" onclick="openLinkGenerator()">ç«‹å³ä½¿ç”¨</button>
                </div>
                <div class="tool-card">
                    <div class="tool-icon">ğŸ“Š</div>
                    <h3 class="tool-title">æ¨å¹¿æ•°æ®ç»Ÿè®¡</h3>
                    <p class="tool-description">å®æ—¶æŸ¥çœ‹æ¨å¹¿æ•°æ®ï¼Œåˆ†æè½¬åŒ–æ•ˆæœå’Œæ”¶ç›Šæƒ…å†µ</p>
                    <button class="btn btn-primary" onclick="openAnalytics()">æŸ¥çœ‹ç»Ÿè®¡</button>
                </div>
                <div class="tool-card">
                    <div class="tool-icon">ğŸ“±</div>
                    <h3 class="tool-title">è¥é”€ç´ æåº“</h3>
                    <p class="tool-description">æä¾›äº§å“ä»‹ç»ã€æ¼”ç¤ºè§†é¢‘ç­‰è¥é”€ç´ æ</p>
                    <button class="btn btn-primary" onclick="openMaterials()">è·å–ç´ æ</button>
                </div>
                <div class="tool-card">
                    <div class="tool-icon">ğŸ’¬</div>
                    <h3 class="tool-title">å®¢æœæ”¯æŒ</h3>
                    <p class="tool-description">ä¸“ä¸šå®¢æœå›¢é˜Ÿï¼Œä¸ºæ‚¨æä¾›æ¨å¹¿æ”¯æŒ</p>
                    <button class="btn btn-primary" onclick="openSupport()">è”ç³»å®¢æœ</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // é¡µé¢åŠ è½½æ—¶è·å–æ¨å¹¿ç»Ÿè®¡
        document.addEventListener('DOMContentLoaded', function() {
            loadPromotionStats();
        });

        // åŠ è½½æ¨å¹¿ç»Ÿè®¡
        async function loadPromotionStats() {
            try {
                const token = localStorage.getItem('authToken');
                const response = await fetch('/api/getAgentStats?agentId=' + getCurrentAgentId(), {
                    headers: {
                        'Authorization': `Bearer ${token}`
                    }
                });
                
                if (response.ok) {
                    const result = await response.json();
                    if (result.data) {
                        updateStatsDisplay(result.data);
                    }
                }
            } catch (error) {
                console.error('åŠ è½½æ¨å¹¿ç»Ÿè®¡å¤±è´¥:', error);
            }
        }

        // æ›´æ–°ç»Ÿè®¡æ˜¾ç¤º
        function updateStatsDisplay(data) {
            document.getElementById('totalPromotions').textContent = data.stats.totalPromotedUsers || 0;
            document.getElementById('totalCommissions').textContent = `Â¥${data.stats.totalCommissions || 0}`;
            document.getElementById('activeUsers').textContent = data.stats.recentUsers || 0;
            document.getElementById('conversionRate').textContent = '15%'; // ç¤ºä¾‹æ•°æ®
        }

        // è·å–å½“å‰ä»£ç†ID
        function getCurrentAgentId() {
            const agentInfo = localStorage.getItem('agentInfo');
            if (agentInfo) {
                const agent = JSON.parse(agentInfo);
                return agent.id;
            }
            return null;
        }

        // ç”Ÿæˆäº§å“æ¨å¹¿é“¾æ¥
        async function generateProductLink(productType) {
            try {
                const token = localStorage.getItem('authToken');
                const response = await fetch('/api/generateProductLink', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                        'Authorization': `Bearer ${token}`
                    },
                    body: JSON.stringify({
                        productType: productType,
                        agentId: getCurrentAgentId()
                    })
                });

                const result = await response.json();
                
                if (response.ok && result.data) {
                    const link = result.data.link;
                    navigator.clipboard.writeText(link).then(() => {
                        alert(`${getProductName(productType)} æ¨å¹¿é“¾æ¥å·²å¤åˆ¶åˆ°å‰ªè´´æ¿ï¼\n\né“¾æ¥: ${link}`);
                    }).catch(() => {
                        prompt('æ¨å¹¿é“¾æ¥ï¼ˆè¯·æ‰‹åŠ¨å¤åˆ¶ï¼‰:', link);
                    });
                } else {
                    alert('ç”Ÿæˆæ¨å¹¿é“¾æ¥å¤±è´¥: ' + (result.message || 'æœªçŸ¥é”™è¯¯'));
                }
            } catch (error) {
                console.error('ç”Ÿæˆæ¨å¹¿é“¾æ¥å¤±è´¥:', error);
                alert('ç”Ÿæˆæ¨å¹¿é“¾æ¥å¤±è´¥ï¼Œè¯·ç¨åé‡è¯•');
            }
        }

        // è·å–äº§å“åç§°
        function getProductName(productType) {
            const names = {
                'google-maps': 'è°·æ­Œåœ°å›¾æ‹“å®¢ç¨‹åº',
                'email-filter': 'é‚®ä»¶è¿‡æ»¤ç¨‹åº',
                'whatsapp-filter': 'WhatsAppè¿‡æ»¤ç¨‹åº'
            };
            return names[productType] || 'äº§å“';
        }

        // æŸ¥çœ‹äº§å“æ¼”ç¤º
        function viewProductDemo(productType) {
            const demos = {
                'google-maps': '/demo/google-maps.html',
                'email-filter': '/demo/email-filter.html',
                'whatsapp-filter': '/demo/whatsapp-filter.html'
            };
            
            const demoUrl = demos[productType];
            if (demoUrl) {
                window.open(demoUrl, '_blank');
            } else {
                alert('æ¼”ç¤ºé¡µé¢æ­£åœ¨å¼€å‘ä¸­ï¼Œæ•¬è¯·æœŸå¾…ï¼');
            }
        }

        // æ¨å¹¿å·¥å…·åŠŸèƒ½
        function openLinkGenerator() {
            alert('æ¨å¹¿é“¾æ¥ç”Ÿæˆå™¨åŠŸèƒ½å¼€å‘ä¸­...');
        }

        function openAnalytics() {
            window.location.href = 'agent-dashboard.html#promotion';
        }

        function openMaterials() {
            alert('è¥é”€ç´ æåº“åŠŸèƒ½å¼€å‘ä¸­...');
        }

        function openSupport() {
            alert('å®¢æœæ”¯æŒåŠŸèƒ½å¼€å‘ä¸­...');
        }
    </script>
</body>
</html>
