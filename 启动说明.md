# 代理系统启动说明

## 🚀 项目已成功配置完成！

### 📁 新增的文件和功能

1. **代理前端页面**：
   - `agent-login.html` - 代理登录页面
   - `agent-register.html` - 代理注册页面  
   - `agent-dashboard.html` - 代理仪表板

2. **代理后端API**：
   - `netlify/functions/agent/` - 代理相关API
   - `netlify/functions/commission/` - 佣金相关API
   - `netlify/functions/withdrawal/` - 提现相关API
   - `netlify/functions/admin/` - 管理相关API

3. **数据库架构**：
   - `database_schema.sql` - 完整的数据库表结构

### 🔧 启动步骤

1. **配置环境变量**：
   ```bash
   # 复制环境变量模板
   cp .env.example .env
   
   # 编辑 .env 文件，填入以下配置：
   SUPABASE_URL=your_supabase_url
   SUPABASE_ANON_KEY=your_supabase_anon_key  
   SUPABASE_SERVICE_ROLE_KEY=your_supabase_service_role_key
   ALIPAY_APP_ID=your_alipay_app_id
   ALIPAY_PRIVATE_KEY=your_alipay_private_key
   ALIPAY_PUBLIC_KEY=your_alipay_public_key
   FRONTEND_URL=http://localhost:8888
   ```

2. **执行数据库脚本**：
   ```sql
   -- 在 Supabase 中执行 database_schema.sql 文件
   ```

3. **启动开发服务器**：
   ```bash
   netlify dev
   ```

4. **访问应用**：
   - 主页面：http://localhost:8888
   - 管理员登录：http://localhost:8888/login.html
   - 代理登录：http://localhost:8888/agent-login.html
   - 代理注册：http://localhost:8888/agent-register.html

### 🎯 功能说明

#### 管理员功能
- 用户管理
- 佣金审核
- 提现处理
- 系统配置

#### 代理功能
- 代理注册（支持邀请码）
- 团队管理
- 佣金查看
- 提现申请
- 用户邀请

### 🔐 登录方式

1. **管理员登录**：
   - 使用现有的管理员账号
   - 访问 `/login.html`

2. **代理登录**：
   - 先注册代理账号
   - 访问 `/agent-login.html`

### 📊 代理系统流程

1. **代理注册** → 获得邀请码
2. **邀请用户** → 用户通过邀请码注册
3. **用户下单** → 自动生成佣金记录
4. **管理员审核** → 审核通过后发放佣金
5. **代理提现** → 申请提现，管理员处理

### ⚠️ 注意事项

1. **环境变量**：必须配置 Supabase 和支付宝相关配置
2. **数据库**：需要先执行 `database_schema.sql` 创建表结构
3. **支付宝**：需要开通转账到个人账户功能
4. **权限**：确保 Supabase 的 RLS 策略正确配置

### 🛠️ 故障排除

1. **API 调用失败**：检查环境变量配置
2. **数据库错误**：确认表结构已创建
3. **登录失败**：检查用户角色和权限
4. **提现失败**：确认支付宝配置正确

### 📞 技术支持

如果遇到问题，请检查：
1. 控制台错误信息
2. 网络请求状态
3. 数据库连接
4. 环境变量配置

---

**项目已准备就绪，可以开始使用代理系统！** 🎉
